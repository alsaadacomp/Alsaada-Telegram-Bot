# 2๏ธโฃ ุจููุฉ ุงููุดุฑูุน - Project Structure

## ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููููู

```
telegram-bot-template-main/
โ
โโโ ๐ src/                          # ุงูููุฏ ุงููุตุฏุฑู ุงูุฑุฆูุณู
โ   โโโ ๐ bot/                      # ูู ูุง ูุชุนูู ุจุงูุจูุช
โ   โโโ ๐ modules/                  # ุงููุญุฏุงุช ูุงูุฎุฏูุงุช
โ   โโโ ๐ server/                   # ุฎุงุฏู ุงูููุจ (Webhook)
โ   โโโ ๐ config.ts                 # ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู
โ   โโโ ๐ main.ts                   # ููุทุฉ ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ
โ
โโโ ๐ prisma/                       # ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ   โโโ ๐ schema.prisma            # ูุฎุทุท ุงููุงุนุฏุฉ
โ   โโโ ๐ seed.ts                  # ุจูุงูุงุช ุฃูููุฉ
โ
โโโ ๐ generated/                    # ูููุงุช ูููุฏุฉ ุชููุงุฆูุงู
โ   โโโ ๐ prisma/                  # Prisma Client
โ
โโโ ๐ locales/                      # ูููุงุช ุงูุชุฑุฌูุฉ
โ   โโโ ๐ ar.ftl                   # ุงูุนุฑุจูุฉ
โ   โโโ ๐ en.ftl                   # ุงูุฅูุฌููุฒูุฉ
โ
โโโ ๐ docs/                         # ุงูุชูุซูู (ูุฐุง ุงููุฌูุฏ)
โ
โโโ ๐ .env                          # ูุชุบูุฑุงุช ุงูุจูุฆุฉ (ุบูุฑ ูุถูู ูู Git)
โโโ ๐ .env.example                  # ูุซุงู ูููู .env
โโโ ๐ package.json                  # ูุนูููุงุช ุงููุดุฑูุน ูุงูุญุฒู
โโโ ๐ tsconfig.json                 # ุฅุนุฏุงุฏุงุช TypeScript
โโโ ๐ README.md                     # ุงูููู ุงูุชุนุฑููู

```

---

## ๐ ุดุฑุญ ุงููุฌูุฏุงุช ุงูุฑุฆูุณูุฉ

### 1. ูุฌูุฏ `src/` - ุงูููุฏ ุงููุตุฏุฑู

#### ๐ `src/bot/` - ููุทู ุงูุจูุช

```
src/bot/
โโโ ๐ callback-data/        # ุจูุงุฉ ุจูุงูุงุช Callback
โ   โโโ language.data.ts     # ุจูุงูุงุช ุชุบููุฑ ุงููุบุฉ
โ
โโโ ๐ conversations/         # ุงููุญุงุฏุซุงุช ุงูุชูุงุนููุฉ
โ   โโโ index.ts             # ุชุตุฏูุฑ ุงููุญุงุฏุซุงุช
โ
โโโ ๐ features/             # ููุฒุงุช ุงูุจูุช
โ   โโโ admin.ts             # ููุฒุงุช ุงููุณุคูููู
โ   โโโ language.ts          # ุชุบููุฑ ุงููุบุฉ
โ   โโโ unhandled.ts         # ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุบูุฑ ุงููุนุฑููุฉ
โ   โโโ welcome.ts           # ุงูุชุฑุญูุจ ูุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ
โ
โโโ ๐ filters/              # ููุงุชุฑ ุงูุชุญุฏูุซุงุช
โ   โโโ is-admin.filter.ts   # ููุชุฑ ุงููุณุคูููู
โ
โโโ ๐ handlers/             # ูุนุงูุฌุงุช ุงูุฃุญุฏุงุซ
โ   โโโ error.ts             # ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
โ
โโโ ๐ helpers/              # ุฏูุงู ูุณุงุนุฏุฉ
โ   โโโ logging.ts           # ุณุฌูุงุช ุงูุชุตุญูุญ
โ
โโโ ๐ keyboards/            # ููุญุงุช ุงูููุงุชูุญ
โ   โโโ language.keyboard.ts # ููุญุฉ ุงุฎุชูุงุฑ ุงููุบุฉ
โ   โโโ remove.keyboard.ts   # ุฅุฒุงูุฉ ุงูููุญุฉ
โ
โโโ ๐ middlewares/          # Middlewares ุงูุจูุช
โ   โโโ session.ts           # ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช
โ   โโโ update-logger.ts     # ุชุณุฌูู ุงูุชุญุฏูุซุงุช
โ
โโโ ๐ context.ts            # ุชุนุฑูู Context
โโโ ๐ index.ts              # ุฅูุดุงุก ูุฅุนุฏุงุฏ ุงูุจูุช
```

**ุงููุธููุฉ:**
- ูุญุชูู ุนูู ูู ูุง ูุชุนูู ุจููุทู ุงูุจูุช
- ููุธู ุญุณุจ ุงููุธุงุฆู (features)
- ูุณุชุฎุฏู ููุท Composer ูุชูุธูู ุงูุฃูุงูุฑ

#### ๐ `src/modules/` - ุงููุญุฏุงุช ูุงูุฎุฏูุงุช

```
src/modules/
โโโ ๐ database/              # ูุญุฏุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ   โโโ ๐ backup/           # ูุณุฎ ุงุญุชูุงุทูุฉ
โ   โโโ ๐ cache/            # ุงูุชุฎุฒูู ุงููุคูุช
โ   โโโ ๐ repositories/     # ููุท Repository
โ   โโโ ๐ transactions/     # ุงููุนุงููุงุช ุงููุนูุฏุฉ
โ   โโโ ๐ index.ts          # Database Class ุงูุฑุฆูุณู
โ
โโโ ๐ input/                 # ูุนุงูุฌุฉ ุงููุฏุฎูุงุช
โ   โโโ ๐ parsers/          # ูุญููุงุช ุงูุจูุงูุงุช
โ   โโโ ๐ validators/       # ูุญููุงุช ุงูุตุญุฉ
โ
โโโ ๐ interaction/           # ุงูุชูุงุนูุงุช
โ   โโโ ๐ confirmations/    # ุฑุณุงุฆู ุงูุชุฃููุฏ
โ   โโโ ๐ menus/            # ุงูููุงุฆู
โ   โโโ ๐ navigation/       # ุงูุชููู
โ   โโโ ๐ wizards/          # ุงููุนุงูุฌุงุช ุงูุชูุงุนููุฉ
โ       โโโ greeting.ts      # ูุซุงู: ูุญุงุฏุซุฉ ุงูุชุฑุญูุจ
โ
โโโ ๐ reports/               # ุงูุชูุงุฑูุฑ
โ   โโโ ๐ generators/       # ูููุฏุงุช ุงูุชูุงุฑูุฑ
โ
โโโ ๐ services/              # ุงูุฎุฏูุงุช
    โโโ ๐ i18n-extended/    # ุงูุชุนุฏุฏ ุงููุบูู
    โ   โโโ i18n.ts          # ุฅุนุฏุงุฏ i18n
    โ   โโโ helpers.ts       # ุฏูุงู ูุณุงุนุฏุฉ
    โโโ ๐ logger/           # ุฎุฏูุฉ ุงูุณุฌูุงุช
    โ   โโโ index.ts         # Pino Logger
    โโโ ๐ permissions/      # ุงูุตูุงุญูุงุช
    โ   โโโ role-manager.ts  # ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ
    โโโ ๐ scheduler/        # ุงูููุงู ุงููุฌุฏููุฉ
        โโโ task-manager.ts  # ุฅุฏุงุฑุฉ ุงูููุงู
```

**ุงููุธููุฉ:**
- ูุญุฏุงุช ูุณุชููุฉ ูุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู
- ุฎุฏูุงุช ูุดุชุฑูุฉ ุนุจุฑ ุงูุชุทุจูู
- ููุทู ุงูุนูู ุงูุฃุณุงุณู

#### ๐ `src/server/` - ุฎุงุฏู ุงูููุจ

```
src/server/
โโโ ๐ middlewares/          # Middlewares ุงูุฎุงุฏู
โ   โโโ telegram-auth.ts     # ูุตุงุฏูุฉ Telegram
โ
โโโ ๐ index.ts              # ุฅุนุฏุงุฏ ุฎุงุฏู Hono
```

**ุงููุธููุฉ:**
- ุฎุงุฏู HTTP ููุถุน Webhook
- ูุจูู ุนูู Hono (ุณุฑูุน ูุฎููู)
- ูุณุชูุจู ุชุญุฏูุซุงุช Telegram

---

## ๐ ุงููููุงุช ุงูุฑุฆูุณูุฉ

### `src/main.ts` - ููุทุฉ ุงูุจุฏุงูุฉ

```typescript
// ููู main.ts ูู ููุทุฉ ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ ููุชุทุจูู
// ูููู ุจู:
// 1. ุชุญููู ุงูุฅุนุฏุงุฏุงุช
// 2. ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
// 3. ุฅูุดุงุก ุงูุจูุช
// 4. ุจุฏุก ุงูุชุดุบูู (Polling ุฃู Webhook)
// 5. ุฅุนุฏุงุฏ Graceful Shutdown
```

**ุงููุณุคูููุงุช:**
- โ ุชููุฆุฉ ุงูุชุทุจูู
- โ ุฅุฏุงุฑุฉ ุฏูุฑุฉ ุญูุงุฉ ุงูุจูุช
- โ ูุนุงูุฌุฉ ุงูุฅุบูุงู ุงูุขูู

### `src/config.ts` - ุงูุฅุนุฏุงุฏุงุช

```typescript
// ุชุญููู ูุชุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
// ูุณุชุฎุฏู ููุชุจุฉ Valibot ููุชุญูู
// ูููุฑ ุฃููุงุน TypeScript ูููุฉ
```

**ุงููุณุคูููุงุช:**
- โ ุชุญููู `.env`
- โ ุงูุชุญูู ูู ุตุญุฉ ุงููุชุบูุฑุงุช
- โ ุชูููุฑ ุฅุนุฏุงุฏุงุช ููุชูุจุฉ

### `src/bot/context.ts` - ุณูุงู ุงูุจูุช

```typescript
export interface Context extends GrammyContext {
  // ุฅุถุงูุงุช ูุฎุตุตุฉ ููู Context
  config: Config
  logger: Logger
  // ... ุงููุฒูุฏ
}
```

**ุงููุธููุฉ:**
- ูุญุฏุฏ ููุน Context ุงููุณุชุฎุฏู ูู ูู ูุนุงูุฌุงุช ุงูุจูุช
- ูุถูู ุฎุตุงุฆุต ูุฎุตุตุฉ (config, logger, etc.)
- ูุณุชุฎุฏู ูู ูู ุฏุงูุฉ ูุนุงูุฌุฉ

---

## ๐๏ธ ูุฌูุฏ `prisma/`

### `prisma/schema.prisma` - ุงููุฎุทุท

```prisma
// ุชุนุฑูู ููุงุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช
// ูุซุงู: User, Role, etc.

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id           Int       @id @default(autoincrement())
  telegramId   BigInt    @unique
  username     String?   @unique
  firstName    String?
  role         Role      @default(GUEST)
  // ...
}
```

**ุงููุธููุฉ:**
- ูุญุฏุฏ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุณุชุฎุฏู ูุชูููุฏ Migrations
- ูููุฏ Prisma Client

### `prisma/seed.ts` - ุงูุจูุงูุงุช ุงูุฃูููุฉ

```typescript
// ููุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุจูุงูุงุช ุชุฌุฑูุจูุฉ
// ููุดุบู ุจุฃูุฑ: npm run db:seed
```

---

## ๐ ูุฌูุฏ `locales/` - ุงูุชุฑุฌูุงุช

```
locales/
โโโ ar.ftl    # ุงููุบุฉ ุงูุนุฑุจูุฉ
โโโ en.ftl    # ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ
```

**ุตูุบุฉ ุงููููุงุช (Fluent):**

```fluent
# en.ftl
welcome = Welcome!
language-select = Please select your language:

# ar.ftl
welcome = ูุฑุญุจุงู!
language-select = ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ูุบุชู:
```

---

## โ๏ธ ูููุงุช ุงูุฅุนุฏุงุฏ

### `package.json`

```json
{
  "name": "telegram-bot-template",
  "type": "module", // ููู: ES Modules
  "imports": {
    "#root/*": "./src/*" // ูุณุงุฑุงุช ูุฎุชุตุฑุฉ
  },
  "scripts": {
    // ุฃูุงูุฑ ุงููุดุฑูุน
  }
}
```

**ููุงุญุธุงุช:**
- `"type": "module"` ูุฏุนู ES Modules
- `imports` ูููุณุงุฑุงุช ุงููุฎุชุตุฑุฉ (#root)

### `tsconfig.json`

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "NodeNext",
    "moduleResolution": "NodeNext",
    "paths": {
      "#root/*": ["./src/*"] // ูุทุงุจู ูู package.json
    }
    // ...
  }
}
```

**ููุงุญุธุงุช:**
- `NodeNext` ูุฏุนู ES Modules
- `paths` ูุฌุจ ุฃู ูุทุงุจู package.json

---

## ๐ฏ ููุท ุงูุชูุธูู ุงููุชุจุน

### 1. **Feature-Based Organization**

ุงูููุฒุงุช ููุธูุฉ ูู ูุฌูุฏุงุช ูููุตูุฉ:
- โ ูู ููุฒุฉ ูู ููู ูุณุชูู
- โ ุณูููุฉ ุงูุฅุถุงูุฉ/ุงูุญุฐู
- โ ุนุฒู ุงููุณุคูููุงุช

### 2. **Modular Architecture**

ุงููุญุฏุงุช ูุณุชููุฉ ููุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู:
- โ Database module
- โ Logger service
- โ i18n service
- โ Permissions system

### 3. **Type Safety**

TypeScript ูู ูู ููุงู:
- โ ุฃููุงุน ูููุฉ ููู Context
- โ ุฃููุงุน Prisma ุงููููุฏุฉ
- โ ุฃููุงุน ููุฅุนุฏุงุฏุงุช

### 4. **Separation of Concerns**

ูุตู ูุงุถุญ ุจูู:
- ๐ต Bot Logic (src/bot)
- ๐ข Business Logic (src/modules)
- ๐ก Infrastructure (src/server, prisma)

---

## ๐ ุชุฏูู ุงูุชุทุจูู

```
1. main.ts ูุจุฏุฃ ุงูุชุทุจูู
   โ
2. ุชุญููู config.ts (ุงูุฅุนุฏุงุฏุงุช)
   โ
3. Database.connect() (ุงูุงุชุตุงู ุจุงููุงุนุฏุฉ)
   โ
4. createBot() (ุฅูุดุงุก ุงูุจูุช)
   โ
5. ุชุณุฌูู Features & Middlewares
   โ
6. ุจุฏุก Polling ุฃู Webhook
   โ
7. ุงุณุชูุจุงู ููุนุงูุฌุฉ ุงูุชุญุฏูุซุงุช
```

---

## ๐ ุฃูุถู ุงูููุงุฑุณุงุช

### ุนูุฏ ุฅุถุงูุฉ ูููุงุช ุฌุฏูุฏุฉ:

1. **Features** โ `src/bot/features/`
2. **Middlewares** โ `src/bot/middlewares/`
3. **Services** โ `src/modules/services/`
4. **Database Logic** โ `src/modules/database/`
5. **Conversations** โ `src/modules/interaction/wizards/`

### ุงูููุงุนุฏ ุงูุนุงูุฉ:

โ **ุงุณุชุฎุฏู TypeScript ุฏุงุฆูุงู**
โ **ุงุชุจุน ููุท Composer ูุชูุธูู ุงูุฃูุงูุฑ**
โ **ุงูุตู ููุทู ุงูุนูู ุนู ููุทู ุงูุจูุช**
โ **ุงุณุชุฎุฏู async/await ููุนูููุงุช ุบูุฑ ุงููุชุฒุงููุฉ**
โ **ุฃุถู ุชุนูููุงุช ููููุฏ ุงููุนูุฏ**
โ **ุงุชุจุน ููุท ุงูุชุณููุฉ ุงููุชุจุน**

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุงูุขู ุจุนุฏ ููู ุจููุฉ ุงููุดุฑูุน:

1. [โ๏ธ ุชุนุฑู ุนูู ุงูุฅุนุฏุงุฏุงุช](./03-configuration.md)
2. [๐๏ธ ุชุนูู ุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช](./04-database.md)
3. [๐ค ุงุณุชูุดู ููุฒุงุช ุงูุจูุช](./05-bot-features.md)

---

[โฌ๏ธ ุงูุณุงุจู: ุงูุจุฏุก ุงูุณุฑูุน](./01-getting-started.md) | [โฌ๏ธ ุงูุนูุฏุฉ ููููุฑุณ](./README.md) | [โก๏ธ ุงูุชุงูู: ุงูุฅุนุฏุงุฏุงุช](./03-configuration.md)
