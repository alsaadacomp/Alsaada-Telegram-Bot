# ๐ ุฏููู ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุงุญุชุฑุงูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุฅุดุนุงุฑุงุช ุดุงูู ูููู ูุฏุนู:
- โ ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูุฑุฏูุฉ ูุฌูุงุนูุฉ
- โ 7 ุฃููุงุน ูุฎุชููุฉ ูู ุงูุฅุดุนุงุฑุงุช
- โ 4 ูุณุชููุงุช ููุฃููููุฉ
- โ 8 ูุฆุงุช ูุณุชูุฏูุฉ ูุฎุชููุฉ
- โ ููุงูุจ ุฌุงูุฒุฉ ูุงุจูุฉ ููุชุฎุตูุต
- โ ุฌุฏููุฉ ูุชูุฑุงุฑ ุงูุฅุดุนุงุฑุงุช
- โ ุณุฌู ูุฅุญุตุงุฆูุงุช ุชูุตูููุฉ
- โ ุชูุถููุงุช ุงููุณุชุฎุฏู ูุณุงุนุงุช ุงููุฏูุก

---

## ๐ฏ ููููุฉ ุนูู ุงููุธุงู

### 1. **ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ** (Settings)

ูููู ููุณูุจุฑ ุฃุฏูู ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ูู: **โ๏ธ ุงูุฅุนุฏุงุฏุงุช โ ๐ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช**

#### ุฅุนุฏุงุฏุงุช ูุชุงุญุฉ:

| ุงูุฅุนุฏุงุฏ | ุงููุตู | ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ |
|--------|------|-------------------|
| `notifications.enabled` | ุชูุนูู/ุชุนุทูู ูุธุงู ุงูุฅุดุนุงุฑุงุช ุจุงููุงูู | `true` (ููุนู) |
| `notifications.default_priority` | ุงูุฃููููุฉ ุงูุงูุชุฑุงุถูุฉ ููุฅุดุนุงุฑุงุช ุงูุฌุฏูุฏุฉ | `normal` (ุนุงุฏู) |

**ูุซุงู:**
- ุฅุฐุง ููุช ุจุชุนุทูู `notifications.enabled`ุ ูู ูุชู ุฅุฑุณุงู **ุฃู** ุฅุดุนุงุฑ ูู ุงููุธุงู ุจุงููุงูู.
- ุฅุฐุง ุบูุฑุช `default_priority` ุฅูู `critical`ุ ูู ุงูุฅุดุนุงุฑุงุช ุงูุฌุฏูุฏุฉ ุงูุชู ูู ุชุญุฏุฏ ุฃููููุชูุง ุณุชููู ุญุฑุฌุฉ.

---

### 2. **ุฃููุงุน ุงูุฅุดุนุงุฑุงุช** (Notification Types)

ูุฏุนู ุงููุธุงู 7 ุฃููุงุน:

| ุงูููุน | ุงูุฑูุฒ | ุงูุงุณุชุฎุฏุงู |
|------|------|-----------|
| `info` | โน๏ธ | ูุนูููุงุช ุนุงูุฉ |
| `success` | โ | ุฅุฎุทุงุฑ ูุฌุงุญ ุนูููุฉ |
| `warning` | โ๏ธ | ุชุญุฐูุฑุงุช |
| `error` | โ | ุฃุฎุทุงุก |
| `announcement` | ๐ข | ุฅุนูุงูุงุช ุนุงูุฉ |
| `reminder` | ๐ | ุชุฐููุฑุงุช |
| `alert` | ๐จ | ุชูุจููุงุช ุนุงุฌูุฉ |

**ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู:**
```typescript
// ุฅุฑุณุงู ุฅุดุนุงุฑ ูุฌุงุญ
await notificationService.sendToAllUsers({
  message: 'ุชู ุฅุถุงูุฉ ุงูููุชุฌ ุจูุฌุงุญ!',
  type: 'success',
  priority: 'normal'
})

// ุฅุฑุณุงู ุชูุจูู ุญุฑุฌ
await notificationService.sendToAdmins({
  message: 'ุงูุชุดุงู ูุญุงููุฉ ุงุฎุชุฑุงู!',
  type: 'alert',
  priority: 'critical'
})
```

---

### 3. **ูุณุชููุงุช ุงูุฃููููุฉ** (Priority Levels)

4 ูุณุชููุงุช ูู ุงูุฃููููุฉ:

| ุงููุณุชูู | ุงูุฑูุฒ | ุงููุตู |
|---------|------|-------|
| `normal` | ๐ต | ุฅุดุนุงุฑุงุช ุนุงุฏูุฉ |
| `important` | ๐ก | ุฅุดุนุงุฑุงุช ูููุฉ ุชุญุชุงุฌ ุงูุชุจุงู |
| `urgent` | ๐ | ุฅุดุนุงุฑุงุช ุนุงุฌูุฉ |
| `critical` | ๐ด | ุฅุดุนุงุฑุงุช ุญุฑุฌุฉ ุฌุฏุงู |

**ุงูุชุฃุซูุฑ:**
- ุนูุฏูุง ุชุถุจุท ุงูุฃููููุฉ ุงูุงูุชุฑุงุถูุฉ ุนูู `critical`ุ ูู ุฅุดุนุงุฑ ุฌุฏูุฏ (ุจุฏูู ุฃููููุฉ ูุญุฏุฏุฉ) ุณูุตุจุญ ุญุฑุฌุงู.

---

### 4. **ุงููุฆุงุช ุงููุณุชูุฏูุฉ** (Target Audiences)

8 ูุฆุงุช ูุฎุชููุฉ:

| ุงููุฆุฉ | ุงููุตู | ูุซุงู ุงุณุชุฎุฏุงู |
|------|-------|--------------|
| `all_users` | ๐ฅ ุฌููุน ุงููุณุชุฎุฏููู | ุฅุนูุงูุงุช ุนุงูุฉ |
| `all_admins` | ๐จโ๐ผ ุฌููุน ุงูุฅุฏุงุฑููู | ุชุญุฏูุซุงุช ุฅุฏุงุฑูุฉ |
| `super_admin` | โญ ุงูุณูุจุฑ ุฃุฏูู ููุท | ุชูุจููุงุช ูุธุงู ุญุฑุฌุฉ |
| `role` | ๐ญ ุฏูุฑ ูุญุฏุฏ (ADMIN, USER, etc.) | ุฅุดุนุงุฑุงุช ุฎุงุตุฉ ุจุฏูุฑ |
| `specific_users` | ๐ ูุณุชุฎุฏููู ูุญุฏุฏูู | ุฅุดุนุงุฑุงุช ุดุฎุตูุฉ |
| `active_users` | โ ุงููุณุชุฎุฏููู ุงููุดุทูู | ุนุฑูุถ ุฎุงุตุฉ |
| `inactive_users` | ๐ค ุงููุณุชุฎุฏููู ุบูุฑ ุงููุดุทูู | ุชุฐููุฑ ุจุงูุนูุฏุฉ |
| `new_users` | ๐ ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ | ุฑุณุงุฆู ุชุฑุญูุจ |

**ูุซุงู:**
```typescript
// ุฅุฑุณุงู ูุฌููุน ุงููุณุชุฎุฏููู ุงููุดุทูู
await notificationService.sendToActiveUsers({
  message: 'ุนุฑุถ ุฎุงุต ููุฏุฉ 24 ุณุงุนุฉ! ๐',
  type: 'announcement',
  priority: 'important'
})

// ุฅุฑุณุงู ููุณูุจุฑ ุฃุฏูู ููุท
await notificationService.sendToSuperAdmin({
  message: 'ุชู ุงูุชุดุงู ุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช',
  type: 'error',
  priority: 'critical'
})
```

---

## ๐จ ููุญุฉ ุงูุฅุดุนุงุฑุงุช (Notifications Panel)

### ุงููุตูู:
**ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ โ ๐ ููุญุฉ ุงูุฅุดุนุงุฑุงุช**

### ุงูุฃูุณุงู ุงููุชุงุญุฉ:

#### 1. **๐ค ุฅุฑุณุงู ุฅุดุนุงุฑ**

**ุฅุดุนุงุฑ ูุฑุฏู:**
- ุฅุฑุณุงู ุฅุดุนุงุฑ ููุณุชุฎุฏู ูุญุฏุฏ (ูุฑูุจุงู)

**ุฅุดุนุงุฑ ุฌูุงุนู:**
1. ุงุฎุชุฑ ุงููุฆุฉ ุงููุณุชูุฏูุฉ (ูู ุงููุณุชุฎุฏูููุ ุงูุฅุฏุงุฑูููุ ุฅูุฎ)
2. ุงุฎุชุฑ ููุน ุงูุฅุดุนุงุฑ (ูุนูููุงุชุ ุชุญุฐูุฑุ ุฅูุฎ)
3. ุงุฎุชุฑ ุงูุฃููููุฉ (ุนุงุฏูุ ูููุ ุนุงุฌูุ ุญุฑุฌ)
4. ุฃุฏุฎู ูุต ุงูุฑุณุงูุฉ
5. ุฅุฑุณุงู

#### 2. **๐ ุงูููุงูุจ ุงูุฌุงูุฒุฉ**

ููุงูุจ ูุญุฏุฏุฉ ูุณุจูุงู ููุงุณุชุฎุฏุงูุงุช ุงูุดุงุฆุนุฉ:

| ุงููุงูุจ | ุงููุตู | ุงููุชุบูุฑุงุช |
|--------|-------|-----------|
| ๐ **ุชุฑุญูุจ** | ุฑุณุงูุฉ ุชุฑุญูุจ ูููุณุชุฎุฏููู ุงูุฌุฏุฏ | `userName`, `botName` |
| โ **ุชุณุฌูู ูุงุฌุญ** | ุฅุดุนุงุฑ ูุฌุงุญ ุงูุชุณุฌูู | `userName`, `userId` |
| ๐ **ุชูุฑูุฑ ุฌุงูุฒ** | ุฅุดุนุงุฑ ุจุฌุงูุฒูุฉ ุงูุชูุฑูุฑ | `reportName`, `date` |
| ๐จ **ุชูุจูู ูุธุงู** | ุชูุจูู ููุดููุฉ ูู ุงููุธุงู | `alertMessage`, `timestamp` |
| ๐ซ **ุญุธุฑ ูุณุชุฎุฏู** | ุฅุดุนุงุฑ ุจุญุธุฑ ูุณุชุฎุฏู | `userName`, `reason`, `adminName` |
| ๐ง **ูุถุน ุตูุงูุฉ** | ุฅุนูุงู ูุถุน ุงูุตูุงูุฉ | `startTime`, `duration` |

**ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู:**
```typescript
// ุฅุฑุณุงู ูู ูุงูุจ
await notificationService.sendFromTemplate(
  'welcome',
  { audience: 'specific_users', userIds: [12345] },
  { userName: 'ุฃุญูุฏ', botName: 'ุจูุช ุงูุณุนุงุฏุฉ' }
)
```

#### 3. **๐ ุณุฌู ุงูุฅุดุนุงุฑุงุช**

- ุนุฑุถ ุขุฎุฑ 10 ุฅุดุนุงุฑุงุช ุชู ุฅุฑุณุงููุง
- ูุธูุฑ ุงูุญุงูุฉุ ุงูููุนุ ุงูุฃููููุฉุ ุนุฏุฏ ุงููุณุชููููุ ุงููุฌุงุญ/ุงููุดู
- ุฅููุงููุฉ ูุณุญ ุงูุณุฌู

#### 4. **๐ ุฅุญุตุงุฆูุงุช ุงูุฅุดุนุงุฑุงุช**

ุฅุญุตุงุฆูุงุช ุดุงููุฉ ุชุดูู:
- **ุงููุฌููุน ุงูููู**: ุนุฏุฏ ุงูุฅุดุนุงุฑุงุชุ ูุณุจุฉ ุงููุฌุงุญ
- **ุญุณุจ ุงูุญุงูุฉ**: ูุฑุณูุ ูุดูุ ูุนููุ ูุฌุฏููุ ููุบู
- **ุญุณุจ ุงูุฃููููุฉ**: ุนุงุฏูุ ูููุ ุนุงุฌูุ ุญุฑุฌ
- **ุญุณุจ ุงูููุน**: ูุนูููุงุชุ ูุฌุงุญุ ุชุญุฐูุฑุ ุฎุทุฃุ ุฅุนูุงูุ ุชุฐููุฑุ ุชูุจูู
- **ุญุณุจ ุงููุฆุฉ ุงููุณุชูุฏูุฉ**: ูู ุงููุณุชุฎุฏูููุ ุงูุฅุฏุงุฑูููุ ุฅูุฎ

---

## ๐ป ุงูุงุณุชุฎุฏุงู ุงูุจุฑูุฌู (ูููุทูุฑูู)

### 1. **ุงูุฅุฑุณุงู ุงูุจุณูุท**

```typescript
import { NotificationService } from '#root/modules/notifications/notification-service.js'

const notificationService = new NotificationService()

// ุฅุฑุณุงู ูุฌููุน ุงููุณุชุฎุฏููู
await notificationService.sendToAllUsers({
  message: 'ุฅุนูุงู ููู!',
  type: 'announcement',
  priority: 'important'
})

// ุฅุฑุณุงู ููุฅุฏุงุฑููู
await notificationService.sendToAdmins({
  message: 'ุชูุฑูุฑ ุฌุฏูุฏ ูุชุงุญ',
  type: 'info'
})

// ุฅุฑุณุงู ููุณูุจุฑ ุฃุฏูู
await notificationService.sendToSuperAdmin({
  message: 'ุชูุจูู ุฃููู',
  type: 'alert',
  priority: 'critical'
})
```

### 2. **ุงูุฅุฑุณุงู ุญุณุจ ุงูุฏูุฑ**

```typescript
// ุฅุฑุณุงู ูุฏูุฑ ูุนูู
await notificationService.sendToRole('ADMIN', {
  message: 'ุงุฌุชูุงุน ุงูุฅุฏุงุฑุฉ ุบุฏุงู',
  type: 'reminder',
  priority: 'important'
})
```

### 3. **ุงูุฅุฑุณุงู ููุณุชุฎุฏููู ูุญุฏุฏูู**

```typescript
// ุฅุฑุณุงู ููุณุชุฎุฏููู ูุญุฏุฏูู
await notificationService.sendToUsers(
  [123, 456, 789], // ูุนุฑูุงุช ุงููุณุชุฎุฏููู
  {
    message: 'ุฑุณุงูุฉ ุฎุงุตุฉ',
    type: 'info'
  }
)
```

### 4. **ุฌุฏููุฉ ุงูุฅุดุนุงุฑุงุช**

```typescript
// ุฌุฏููุฉ ุฅุดุนุงุฑ ูู ููุช ูุญุฏุฏ
const notificationId = await notificationService.schedule(
  {
    message: 'ุชุฐููุฑ ุจุงูุงุฌุชูุงุน',
    type: 'reminder',
    priority: 'important'
  },
  { audience: 'all_admins' },
  { scheduledAt: new Date('2024-12-25 10:00:00') }
)

// ุฅูุบุงุก ุฅุดุนุงุฑ ูุฌุฏูู
notificationService.cancelScheduled(notificationId)
```

### 5. **ุงูุฅุดุนุงุฑุงุช ุงููุชูุฑุฑุฉ**

```typescript
// ุฅุดุนุงุฑ ูููู
await notificationService.scheduleRecurring(
  {
    message: 'ุชูุฑูุฑ ูููู',
    type: 'info'
  },
  { audience: 'all_admins' },
  {
    recurring: {
      frequency: 'daily',
      time: '09:00' // ูู ููู ุงูุณุงุนุฉ 9 ุตุจุงุญุงู
    }
  }
)

// ุฅุดุนุงุฑ ุฃุณุจูุนู
await notificationService.scheduleRecurring(
  {
    message: 'ุชูุฑูุฑ ุฃุณุจูุนู',
    type: 'info'
  },
  { audience: 'super_admin' },
  {
    recurring: {
      frequency: 'weekly',
      daysOfWeek: [1], // ุงูุฅุซููู (0 = ุงูุฃุญุฏ)
      time: '10:00'
    }
  }
)
```

### 6. **ุงุณุชุฎุฏุงู ุงูููุงูุจ**

```typescript
// ุฅูุดุงุก ูุงูุจ ูุฎุตุต
import { NotificationTemplateBuilder } from '#root/modules/notifications/core/notification-template.js'

const template = new NotificationTemplateBuilder(
  'custom_template',
  'ูุงูุจ ูุฎุตุต',
  'ูุฑุญุจุงู {{userName}}ุ ูุฏูู {{count}} ุฑุณุงุฆู ุฌุฏูุฏุฉ'
)
template.setType('info')
template.setPriority('normal')
template.setVariables(['userName', 'count'])

// ุชุณุฌูู ุงููุงูุจ
notificationService.registerTemplate(template)

// ุงุณุชุฎุฏุงู ุงููุงูุจ
await notificationService.sendFromTemplate(
  'custom_template',
  { audience: 'specific_users', userIds: [123] },
  { userName: 'ุฃุญูุฏ', count: 5 }
)
```

### 7. **ุชูุถููุงุช ุงููุณุชุฎุฏู**

```typescript
// ุถุจุท ุชูุถููุงุช ุงููุณุชุฎุฏู
notificationService.setUserPreferences(123, {
  enabled: true,
  types: ['info', 'announcement'], // ูุณุชูุจู ููุท ุงููุนูููุงุช ูุงูุฅุนูุงูุงุช
  priorities: ['important', 'critical'], // ูุณุชูุจู ููุท ุงูููู ูุงูุญุฑุฌ
  quietHours: {
    enabled: true,
    start: '22:00',
    end: '08:00' // ูุง ุฅุดุนุงุฑุงุช ูู 10 ูุณุงุกู ุฅูู 8 ุตุจุงุญุงู
  }
})
```

### 8. **ุงูุฅุญุตุงุฆูุงุช ูุงูุณุฌู**

```typescript
// ุงูุญุตูู ุนูู ุงูุณุฌู
const history = notificationService.getHistory(20) // ุขุฎุฑ 20 ุฅุดุนุงุฑ

// ุงูุญุตูู ุนูู ุงูุฅุญุตุงุฆูุงุช
const stats = notificationService.getStatistics()
console.log(`ูุนุฏู ุงููุฌุงุญ: ${stats.successRate}%`)
console.log(`ุงูุฅุฌูุงูู: ${stats.total}`)

// ูุณุญ ุงูุณุฌู
notificationService.clearHistory()
```

---

## ๐ง ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ูุธุงู ุชุณุฌูู ุงููุณุชุฎุฏููู

```typescript
// ุนูุฏ ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ
async function onUserRegistered(user: any) {
  // 1. ุฅุฑุณุงู ุชุฑุญูุจ ูููุณุชุฎุฏู
  await notificationService.sendToUsers(
    [user.userId],
    {
      message: `ูุฑุญุจุงู ${user.name}! ๐\nุดูุฑุงู ูุงูุถูุงูู ุฅูููุง.`,
      type: 'success',
      priority: 'normal'
    }
  )

  // 2. ุฅุฎุทุงุฑ ุงูุฅุฏุงุฑููู
  await notificationService.sendToAdmins({
    message: `ูุณุชุฎุฏู ุฌุฏูุฏ: ${user.name} (${user.userId})`,
    type: 'info',
    priority: 'normal'
  })
}
```

### ูุซุงู 2: ูุธุงู ุงูุชูุงุฑูุฑ

```typescript
// ุนูุฏ ุฌุงูุฒูุฉ ุงูุชูุฑูุฑ
async function onReportReady(report: any) {
  await notificationService.sendFromTemplate(
    'report_ready',
    { audience: 'super_admin' },
    {
      reportName: report.name,
      date: new Date().toLocaleDateString('ar')
    }
  )
}
```

### ูุซุงู 3: ูุธุงู ุงูุชูุจููุงุช

```typescript
// ุนูุฏ ุงูุชุดุงู ูุดููุฉ
async function onSystemError(error: any) {
  await notificationService.sendToSuperAdmin({
    message: `โ๏ธ ุฎุทุฃ ูู ุงููุธุงู!\n\n${error.message}\n\nุงูููุช: ${new Date().toLocaleString('ar')}`,
    type: 'error',
    priority: 'critical'
  })
}
```

---

## โจ ุงูููุฒุงุช ุงููุณุชูุจููุฉ

- [ ] ูุธุงู ูุญุงุฏุซุฉ ูุฅุฏุฎุงู ุงูุฑุณุงุฆู
- [ ] ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุงููุฑุฏูุฉ ุจุงููุงูู
- [ ] ุฑุจุท ุงูููุงูุจ ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุฅุดุนุงุฑุงุช ุนุจุฑ ุงููููุงุช ุงููุชุนุฏุฏุฉ (Email, SMS)
- [ ] ุชุญูููุงุช ูุชูุฏูุฉ ูุฑุณูู ุจูุงููุฉ
- [ ] ูุธุงู ุงูููุงููุงุช ููุฅุดุนุงุฑุงุช ุงูุญุฑุฌุฉ
- [ ] ุฅููุงููุฉ ุชุญุฑูุฑ ุงูููุงูุจ ูู ุงููุงุฌูุฉ

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ** ุชุคุซุฑ ุนูู **ุฌููุน** ุงูุฅุดุนุงุฑุงุช ูู ุงููุธุงู
2. **ุชูุถููุงุช ุงููุณุชุฎุฏู** ููุง ุฃููููุฉ ุนูู ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ
3. **ุณุงุนุงุช ุงููุฏูุก** ุชููุน ุงูุฅุดุนุงุฑุงุช ูู ุฃููุงุช ูุญุฏุฏุฉ
4. **ุงูุณุฌู** ูุญูุธ ูู ุงูุฐุงูุฑุฉ ุญุงููุงู (ุณูุชู ุฑุจุทู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุญูุงู)
5. **ุงูููุงูุจ** ุชุฏุนู ุงููุชุบูุฑุงุช ุจุตูุบุฉ `{{variableName}}`

---

## ๐ ุงูุฏุนู

ูุฃู ุงุณุชูุณุงุฑุงุช ุฃู ูุดุงููุ ูุฑุฌู ูุฑุงุฌุนุฉ:
- `src/modules/notifications/` - ุงูููุฏ ุงูุฃุณุงุณู
- `src/bot/features/notifications-panel/` - ูุงุฌูุฉ ุงูุจูุช
- `src/modules/settings/default-settings.ts` - ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ

---

**ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ**: ูุธุงู ุฅุฏุงุฑุฉ ุงูุจูุช ุงูุงุญุชุฑุงูู
**ุงูุฅุตุฏุงุฑ**: 1.0.0
**ุงูุชุงุฑูุฎ**: 2024
