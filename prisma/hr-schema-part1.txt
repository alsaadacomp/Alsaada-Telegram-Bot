// ============================================
// HR MANAGEMENT SYSTEM - COMPLETE SCHEMA
// Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø´Ø¦ÙˆÙ† Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† - Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„ÙƒØ§Ù…Ù„
// ============================================
// Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ØªØ¨Ø¯Ø£ Ø¨Ù€ HR_ Ù„ØªÙƒÙˆÙ† Ù…Ø±ØªØ¨Ø© ÙÙŠ Prisma Studio
// ============================================

// Ø³ÙŠØªÙ… Ø¯Ù…Ø¬ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…Ø¹ schema.prisma Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
// ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø¬Ø¯Ø§ÙˆÙ„ Ù†Ø¸Ø§Ù… Ø´Ø¦ÙˆÙ† Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† ÙÙ‚Ø·

// ============================================
// 1. Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ
// ============================================

model HR_Department {
  id          Int        @id @default(autoincrement())
  name        String
  nameEn      String?
  code        String     @unique
  description String?
  managerId   Int?
  orderIndex  Int        @default(0)
  isActive    Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  createdBy   Int?
  updatedBy   Int?

  // Relations
  positions   HR_Position[]
  employees   HR_Employee[]

  @@index([code])
  @@index([isActive])
  @@index([orderIndex])
  @@index([name])
  @@index([createdAt])
}

model HR_Position {
  id            Int           @id @default(autoincrement())
  title         String
  titleAr       String
  code          String        @unique
  description   String?
  
  // Department Relation
  departmentId  Int
  department    HR_Department @relation(fields: [departmentId], references: [id], onDelete: Restrict)
  
  orderIndex    Int           @default(0)
  isActive      Boolean       @default(true)
  
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  createdBy     Int?
  updatedBy     Int?
  
  // Relations
  employees     HR_Employee[]

  @@index([code])
  @@index([departmentId])
  @@index([isActive])
  @@index([title])
  @@index([titleAr])
  @@index([createdAt])
}

// ============================================
// 2. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ†
// ============================================

model HR_Employee {
  id                    Int              @id @default(autoincrement())
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©
  employeeCode          String           @unique
  firstName             String
  firstNameEn           String?
  secondName            String?
  secondNameEn          String?
  thirdName             String?
  thirdNameEn           String?
  lastName              String
  lastNameEn            String?
  fullName              String
  fullNameEn            String?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ©
  nationalId            String           @unique
  passportNumber        String?
  gender                Gender
  dateOfBirth           DateTime
  placeOfBirth          String?
  nationality           String
  maritalStatus         MaritalStatus
  religion              String?
  bloodType             String?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
  personalEmail         String?
  workEmail             String?
  personalPhone         String
  workPhone             String?
  emergencyContactName  String
  emergencyContactPhone String
  emergencyContactRelation String?
  
  // Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
  currentAddress        String
  currentAddressEn      String?
  permanentAddress      String?
  governorateId         Int?
  governorate           Governorate?     @relation("EmployeeGovernorate", fields: [governorateId], references: [id], onDelete: SetNull)
  city                  String
  region                String?
  country               String           @default("Egypt")
  postalCode            String?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ¸ÙŠÙÙŠØ©
  companyId             Int
  company               Company          @relation(fields: [companyId], references: [id], onDelete: Restrict)
  
  departmentId          Int
  department            HR_Department    @relation(fields: [departmentId], references: [id], onDelete: Restrict)
  
  positionId            Int
  position              HR_Position      @relation(fields: [positionId], references: [id], onDelete: Restrict)
  
  employmentType        EmploymentType
  contractType          ContractType
  employmentStatus      EmploymentStatus @default(ACTIVE)
  
  hireDate              DateTime
  confirmationDate      DateTime?
  resignationDate       DateTime?
  terminationDate       DateTime?
  terminationReason     String?
  
  // Ø§Ù„Ø±Ø§ØªØ¨ ÙˆØ§Ù„Ù…Ø²Ø§ÙŠØ§
  basicSalary           Float
  allowances            Float?           @default(0)
  totalSalary           Float
  currency              String           @default("EGP")
  paymentMethod         PaymentMethod    @default(BANK_TRANSFER)
  bankName              String?
  bankAccountNumber     String?
  iban                  String?
  
  // Ø§Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª ÙˆØ§Ù„Ø¶Ø±Ø§Ø¦Ø¨
  socialInsuranceNumber String?
  taxNumber             String?
  insuranceStartDate    DateTime?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…Ù„
  directManagerId       Int?
  directManager         HR_Employee?     @relation("ManagerSubordinates", fields: [directManagerId], references: [id], onDelete: SetNull)
  subordinates          HR_Employee[]    @relation("ManagerSubordinates")
  
  workSchedule          String?
  workLocation          String?
  
  // ğŸ†• Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ
  isFieldWorker         Boolean          @default(true)
  rotationSchedule      String?
  fieldAllowanceRate    Float?           @default(0)
  housingAllowance      Float?           @default(0)
  transportAllowance    Float?           @default(0)
  foodAllowance         Float?           @default(0)
  currentRotationId     Int?
  lastRotationEndDate   DateTime?
  nextRotationStartDate DateTime?
  
  // Ø§Ù„Ù…Ø¤Ù‡Ù„Ø§Øª
  educationLevel        EducationLevel?
  major                 String?
  university            String?
  graduationYear        Int?
  certifications        String?
  
  // Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø®Ø¨Ø±Ø§Øª
  skills                String?
  previousExperience    String?
  yearsOfExperience     Int?             @default(0)
  
  // Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
  profilePhoto          String?
  cv                    String?
  documents             String?
  
  // Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
  annualLeaveBalance    Int              @default(21)
  sickLeaveBalance      Int              @default(180)
  casualLeaveBalance    Int              @default(7)
  
  // Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù
  attendanceRequired    Boolean          @default(false)
  fingerprintId         String?
  
  // Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ­Ø§Ù„Ø©
  notes                 String?
  isActive              Boolean          @default(true)
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØªØ¨Ø¹
  createdAt             DateTime         @default(now())
  updatedAt             DateTime         @updatedAt
  createdBy             Int?
  updatedBy             Int?
  
  // Relations - HR
  rotations             HR_WorkRotation[]       @relation("EmployeeRotations")
  leaves                HR_EmployeeLeave[]      @relation("EmployeeLeaves")
  leaveReplacements     HR_EmployeeLeave[]      @relation("LeaveReplacements")
  advances              HR_EmployeeAdvance[]    @relation("EmployeeAdvances")
  payrolls              HR_MonthlyPayroll[]     @relation("EmployeePayrolls")
  attendanceExceptions  HR_AttendanceException[]
  
  // Relations - Equipment
  operatedEquipment     Equipment[]             @relation("EquipmentOperator")
  performedMaintenance  MaintenanceRecord[]     @relation("MaintenancePerformer")
  equipmentUsages       EquipmentUsage[]        @relation("UsageOperator")
  fuelLogs              FuelLog[]               @relation("FuelOperator")
  shiftAssignments      ShiftAssignment[]       @relation("ShiftOperator")

  @@index([employeeCode])
  @@index([nationalId])
  @@index([companyId])
  @@index([departmentId])
  @@index([positionId])
  @@index([directManagerId])
  @@index([employmentStatus])
  @@index([employmentType])
  @@index([isActive])
  @@index([hireDate])
  @@index([fullName])
  @@index([firstName, lastName])
  @@index([isFieldWorker])
  @@index([currentRotationId])
}

// ============================================
// 3. Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª (Ù„Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ)
// ============================================

model HR_WorkRotation {
  id                    Int                 @id @default(autoincrement())
  
  employeeId            Int
  employee              HR_Employee         @relation("EmployeeRotations", fields: [employeeId], references: [id], onDelete: Cascade)
  
  // Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙˆØ±Ø©
  rotationType          RotationType        @default(STANDARD)
  workDays              Int
  restDays              Int
  
  // Ø§Ù„ÙØªØ±Ø©
  startDate             DateTime
  expectedEndDate       DateTime
  actualEndDate         DateTime?
  
  // Ø§Ù„Ù…ÙˆÙ‚Ø¹
  projectId             Int?
  project               Project?            @relation(fields: [projectId], references: [id], onDelete: SetNull)
  campLocation          String?
  accommodationType     String?
  
  // Ø§Ù„Ø­Ø§Ù„Ø©
  status                RotationStatus      @default(SCHEDULED)
  
  // Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„Ù…Ø¨ÙƒØ±Ø©
  earlyDeparture        Boolean             @default(false)
  earlyDepartureDate    DateTime?
  earlyDepartureReason  String?
  
  // Ø§Ù„ØªÙ…Ø¯ÙŠØ¯
  extended              Boolean             @default(false)
  extensionDays         Int?
  extensionReason       String?
  
  // Ù…Ù„Ø§Ø­Ø¸Ø§Øª
  notes                 String?
  performanceNotes      String?
  
  isActive              Boolean             @default(true)
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
  createdBy             Int?
  updatedBy             Int?

  @@index([employeeId])
  @@index([projectId])
  @@index([status])
  @@index([startDate])
  @@index([expectedEndDate])
  @@index([rotationType])
}

// Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ØªØ£ØªÙŠ ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„ØªØ§Ù„ÙŠ...
