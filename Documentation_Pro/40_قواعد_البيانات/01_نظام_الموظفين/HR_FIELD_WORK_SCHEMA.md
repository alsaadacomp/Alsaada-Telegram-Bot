# ğŸœï¸ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ ÙˆØ§Ù„Ø¯ÙˆØ±Ø§Øª

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØµÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„Ø¥Ø¯Ø§Ø±Ø© **Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠØ©** Ø­ÙŠØ« ÙŠØªÙ… Ø§Ù„Ø¹Ù…Ù„ Ø¨Ù†Ø¸Ø§Ù… **Ø§Ù„Ø¯ÙˆØ±Ø§Øª** (28/7ØŒ 21/7ØŒ 14/7) Ù…Ø¹ ØªØªØ¨Ø¹ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¥Ø¬Ø§Ø²Ø§Øª ÙˆØ§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ø±ÙˆØ§ØªØ¨.

---

## ğŸ¯ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

### âœ… Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆØ±Ø§Øª (Work Rotations)
- ØªØªØ¨Ø¹ Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ (28 ÙŠÙˆÙ… Ø¹Ù…Ù„ / 7 Ø£ÙŠØ§Ù… Ø±Ø§Ø­Ø©)
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ù…Ø®Ø·Ø·Ø©
- ØªØ³Ø¬ÙŠÙ„ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¹Ù…Ù„ Ù„ÙƒÙ„ Ø¯ÙˆØ±Ø©

### âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
- Ø¥Ø¬Ø§Ø²Ø§Øª Ø³Ù†ÙˆÙŠØ©ØŒ Ù…Ø±Ø¶ÙŠØ©ØŒ Ø·Ø§Ø±Ø¦Ø©ØŒ Ø¨Ø¯ÙˆÙ† Ø±Ø§ØªØ¨
- Ù†Ø¸Ø§Ù… Ù…ÙˆØ§ÙÙ‚Ø§Øª Ù…ØªÙƒØ§Ù…Ù„
- ØªØ¹ÙŠÙŠÙ† Ø¨Ø¯ÙŠÙ„ Ù„Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©

### âœ… Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª
- ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ù„Ù
- Ù†Ø¸Ø§Ù… Ù…ÙˆØ§ÙÙ‚Ø§Øª
- ØªØªØ¨Ø¹ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©

### âœ… Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
- Ø­Ø³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ø¨Ø¯Ù„Ø§Øª
- Ø®ØµÙˆÙ…Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© (Ø³Ù„ÙØŒ ØºØ±Ø§Ù…Ø§ØªØŒ ØºÙŠØ§Ø¨)
- ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹

### âœ… Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±
- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ£Ø®ÙŠØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù Ø§Ù„Ù…Ø¨ÙƒØ±
- Ø§Ù„ØºÙŠØ§Ø¨ ÙˆØ§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ
- Ù†Ø¸Ø§Ù… Ù…ÙˆØ§ÙÙ‚Ø§Øª

---

## ğŸ“Š ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸Ù (Employee)

### Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ:

```prisma
model Employee {
  // ... Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ...
  
  // ğŸ†• Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ
  isFieldWorker         Boolean          @default(true)  // Ø¹Ø§Ù…Ù„ Ù…ÙŠØ¯Ø§Ù†ÙŠØŸ
  rotationSchedule      String?          // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆØ±Ø© (28/7, 21/7)
  fieldAllowanceRate    Float?           @default(0)     // Ø¨Ø¯Ù„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ
  housingAllowance      Float?           @default(0)     // Ø¨Ø¯Ù„ Ø³ÙƒÙ†
  transportAllowance    Float?           @default(0)     // Ø¨Ø¯Ù„ Ù…ÙˆØ§ØµÙ„Ø§Øª
  foodAllowance         Float?           @default(0)     // Ø¨Ø¯Ù„ Ø·Ø¹Ø§Ù…
  currentRotationId     Int?             // Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
  lastRotationEndDate   DateTime?        // Ø¢Ø®Ø± Ø¯ÙˆØ±Ø©
  nextRotationStartDate DateTime?        // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
  
  // Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù
  attendanceRequired    Boolean          @default(false) // Ù„ÙŠØ³ Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ
  
  // Relations - HR
  rotations             HR_WorkRotation[]       @relation("EmployeeRotations")
  leaves                HR_EmployeeLeave[]      @relation("EmployeeLeaves")
  leaveReplacements     HR_EmployeeLeave[]      @relation("LeaveReplacements")
  advances              HR_EmployeeAdvance[]    @relation("EmployeeAdvances")
  payrolls              HR_MonthlyPayroll[]     @relation("EmployeePayrolls")
  attendanceExceptions  HR_AttendanceException[]
  
  // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ ...
  
  @@index([isFieldWorker])
  @@index([currentRotationId])
}
```

### ğŸ“ ÙˆØµÙ Ø§Ù„Ø­Ù‚ÙˆÙ„:

| Ø§Ù„Ø­Ù‚Ù„ | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„ÙˆØµÙ |
|------|------|-------|
| `isFieldWorker` | Boolean | Ù‡Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø¹Ø§Ù…Ù„ Ù…ÙŠØ¯Ø§Ù†ÙŠØŸ (Ø§ÙØªØ±Ø§Ø¶ÙŠ: true) |
| `rotationSchedule` | String | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆØ±Ø© Ù…Ø«Ù„ "28/7" Ø£Ùˆ "21/7" |
| `fieldAllowanceRate` | Float | Ø¨Ø¯Ù„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ Ø§Ù„Ø´Ù‡Ø±ÙŠ |
| `housingAllowance` | Float | Ø¨Ø¯Ù„ Ø§Ù„Ø³ÙƒÙ† |
| `transportAllowance` | Float | Ø¨Ø¯Ù„ Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª |
| `foodAllowance` | Float | Ø¨Ø¯Ù„ Ø§Ù„Ø·Ø¹Ø§Ù… |
| `currentRotationId` | Int | Ù…Ø¹Ø±Ù Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø§Ù„Ù†Ø´Ø·Ø© |
| `lastRotationEndDate` | DateTime | ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¢Ø®Ø± Ø¯ÙˆØ±Ø© |
| `nextRotationStartDate` | DateTime | ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© |
| `attendanceRequired` | Boolean | Ù‡Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù…Ø·Ù„ÙˆØ¨ØŸ (false Ù„Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ) |

---

## ğŸ”„ Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ (HR_WorkRotation)

### Ø§Ù„ØºØ±Ø¶:
ØªØªØ¨Ø¹ Ø¯ÙˆØ±Ø§Øª Ø¹Ù…Ù„ Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠØ©.

### Schema:

```prisma
model HR_WorkRotation {
  id                Int       @id @default(autoincrement())
  employeeId        Int
  rotationType      String    // Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙˆØ±Ø©: "28/7", "21/7", "14/7"
  startDate         DateTime
  endDate           DateTime
  status            String    @default("planned") // planned, active, completed, cancelled
  location          String?   // Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ù„
  notes             String?
  
  // Relations
  employee          Employee @relation("EmployeeRotations", fields: [employeeId], references: [id], onDelete: Cascade)
  
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  
  @@index([employeeId])
  @@index([status])
  @@index([startDate, endDate])
}
```

### ğŸ“‹ Ø§Ù„Ø­Ù‚ÙˆÙ„:

| Ø§Ù„Ø­Ù‚Ù„ | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„ÙˆØµÙ | Ù…Ø«Ø§Ù„ |
|------|------|-------|------|
| `id` | Int | Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯ | 1 |
| `employeeId` | Int | Ù…Ø¹Ø±Ù Ø§Ù„Ù…ÙˆØ¸Ù | 123 |
| `rotationType` | String | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆØ±Ø© | "28/7", "21/7", "14/7" |
| `startDate` | DateTime | ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¯ÙˆØ±Ø© | 2025-01-01 |
| `endDate` | DateTime | ØªØ§Ø±ÙŠØ® Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¯ÙˆØ±Ø© | 2025-01-28 |
| `status` | String | Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙˆØ±Ø© | planned, active, completed, cancelled |
| `location` | String | Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ù„ | "Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„ÙˆØ§Ø­Ø§Øª" |
| `notes` | String | Ù…Ù„Ø§Ø­Ø¸Ø§Øª | - |

### ğŸ”„ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø© (Status):

- **planned** ğŸ“… - Ù…Ø®Ø·Ø·Ø© (Ù„Ù… ØªØ¨Ø¯Ø£ Ø¨Ø¹Ø¯)
- **active** ğŸŸ¢ - Ù†Ø´Ø·Ø© (Ø¬Ø§Ø±ÙŠØ© Ø­Ø§Ù„ÙŠØ§Ù‹)
- **completed** âœ… - Ù…ÙƒØªÙ…Ù„Ø© (Ø§Ù†ØªÙ‡Øª)
- **cancelled** âŒ - Ù…Ù„ØºØ§Ø©

### ğŸ’¡ Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:

```typescript
// Ø¥Ù†Ø´Ø§Ø¡ Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©
const rotation = await prisma.hR_WorkRotation.create({
  data: {
    employeeId: 123,
    rotationType: "28/7",
    startDate: new Date("2025-01-01"),
    endDate: new Date("2025-01-28"),
    status: "planned",
    location: "Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„ÙˆØ§Ø­Ø§Øª"
  }
})

// Ø¬Ù„Ø¨ Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù„Ù„Ù…ÙˆØ¸Ù
const activeRotation = await prisma.hR_WorkRotation.findFirst({
  where: {
    employeeId: 123,
    status: "active"
  },
  include: {
    employee: true
  }
})

// Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø¯ÙˆØ±Ø§Øª Ù…ÙˆØ¸Ù
const rotations = await prisma.hR_WorkRotation.findMany({
  where: { employeeId: 123 },
  orderBy: { startDate: 'desc' }
})
```

---

## ğŸ–ï¸ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª (HR_EmployeeLeave)

### Ø§Ù„ØºØ±Ø¶:
Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø¹ Ù†Ø¸Ø§Ù… Ù…ÙˆØ§ÙÙ‚Ø§Øª Ù…ØªÙƒØ§Ù…Ù„.

### Schema:

```prisma
model HR_EmployeeLeave {
  id                Int       @id @default(autoincrement())
  employeeId        Int
  leaveType         String    // annual, sick, emergency, unpaid
  startDate         DateTime
  endDate           DateTime
  totalDays         Int
  reason            String?
  status            String    @default("pending") // pending, approved, rejected, cancelled
  replacementId     Int?      // Ù…Ù† ÙŠØ­Ù„ Ù…Ø­Ù„Ù‡
  approvedBy        Int?
  approvedAt        DateTime?
  rejectionReason   String?
  
  // Relations
  employee          Employee @relation("EmployeeLeaves", fields: [employeeId], references: [id], onDelete: Cascade)
  replacement       Employee? @relation("LeaveReplacements", fields: [replacementId], references: [id])
  
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  
  @@index([employeeId])
  @@index([status])
  @@index([startDate, endDate])
}
```

### ğŸ“‹ Ø§Ù„Ø­Ù‚ÙˆÙ„:

| Ø§Ù„Ø­Ù‚Ù„ | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„ÙˆØµÙ |
|------|------|-------|
| `id` | Int | Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯ |
| `employeeId` | Int | Ù…Ø¹Ø±Ù Ø§Ù„Ù…ÙˆØ¸Ù |
| `leaveType` | String | Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© (annual, sick, emergency, unpaid) |
| `startDate` | DateTime | ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© |
| `endDate` | DateTime | ØªØ§Ø±ÙŠØ® Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© |
| `totalDays` | Int | Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… |
| `reason` | String | Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© |
| `status` | String | Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ (pending, approved, rejected, cancelled) |
| `replacementId` | Int | Ù…Ø¹Ø±Ù Ø§Ù„Ø¨Ø¯ÙŠÙ„ |
| `approvedBy` | Int | Ù…Ù† ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨ |
| `approvedAt` | DateTime | ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© |
| `rejectionReason` | String | Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ |

### ğŸ“ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª:

- **annual** ğŸ–ï¸ - Ø¥Ø¬Ø§Ø²Ø© Ø³Ù†ÙˆÙŠØ©
- **sick** ğŸ¤’ - Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ©
- **emergency** ğŸš¨ - Ø¥Ø¬Ø§Ø²Ø© Ø·Ø§Ø±Ø¦Ø©
- **unpaid** ğŸ’° - Ø¥Ø¬Ø§Ø²Ø© Ø¨Ø¯ÙˆÙ† Ø±Ø§ØªØ¨

### ğŸ”„ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·Ù„Ø¨:

- **pending** â³ - Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
- **approved** âœ… - Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§
- **rejected** âŒ - Ù…Ø±ÙÙˆØ¶Ø©
- **cancelled** ğŸš« - Ù…Ù„ØºØ§Ø©

### ğŸ’¡ Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:

```typescript
// Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© Ø³Ù†ÙˆÙŠØ©
const leave = await prisma.hR_EmployeeLeave.create({
  data: {
    employeeId: 123,
    leaveType: "annual",
    startDate: new Date("2025-02-01"),
    endDate: new Date("2025-02-07"),
    totalDays: 7,
    reason: "Ø¥Ø¬Ø§Ø²Ø© Ø¹Ø§Ø¦Ù„ÙŠØ©",
    replacementId: 456 // Ø§Ù„Ø¨Ø¯ÙŠÙ„
  }
})

// Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø¥Ø¬Ø§Ø²Ø©
const approvedLeave = await prisma.hR_EmployeeLeave.update({
  where: { id: 1 },
  data: {
    status: "approved",
    approvedBy: 999,
    approvedAt: new Date()
  }
})

// Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
const pendingLeaves = await prisma.hR_EmployeeLeave.findMany({
  where: { status: "pending" },
  include: {
    employee: true,
    replacement: true
  }
})
```

---

## ğŸ’° Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª (HR_EmployeeAdvance)

### Ø§Ù„ØºØ±Ø¶:
Ø¥Ø¯Ø§Ø±Ø© Ø³Ù„Ù ÙˆÙ…Ø³Ø­ÙˆØ¨Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø¹ ØªØªØ¨Ø¹ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©.

### Schema:

```prisma
model HR_EmployeeAdvance {
  id                Int       @id @default(autoincrement())
  employeeId        Int
  amount            Float
  reason            String?
  requestDate       DateTime  @default(now())
  approvalStatus    String    @default("pending") // pending, approved, rejected
  approvedBy        Int?
  approvedAt        DateTime?
  deductionStartDate DateTime?
  monthlyDeduction  Float?
  remainingBalance  Float?
  isPaid            Boolean   @default(false)
  notes             String?
  
  // Relations
  employee          Employee @relation("EmployeeAdvances", fields: [employeeId], references: [id], onDelete: Cascade)
  
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  
  @@index([employeeId])
  @@index([approvalStatus])
  @@index([isPaid])
}
```

### ğŸ“‹ Ø§Ù„Ø­Ù‚ÙˆÙ„:

| Ø§Ù„Ø­Ù‚Ù„ | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„ÙˆØµÙ |
|------|------|-------|
| `id` | Int | Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯ |
| `employeeId` | Int | Ù…Ø¹Ø±Ù Ø§Ù„Ù…ÙˆØ¸Ù |
| `amount` | Float | Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ù„ÙØ© |
| `reason` | String | Ø³Ø¨Ø¨ Ø§Ù„Ø³Ù„ÙØ© |
| `requestDate` | DateTime | ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨ |
| `approvalStatus` | String | Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© (pending, approved, rejected) |
| `approvedBy` | Int | Ù…Ù† ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨ |
| `approvedAt` | DateTime | ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© |
| `deductionStartDate` | DateTime | ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø¡ Ø§Ù„Ø®ØµÙ… |
| `monthlyDeduction` | Float | Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… Ø§Ù„Ø´Ù‡Ø±ÙŠ |
| `remainingBalance` | Float | Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ |
| `isPaid` | Boolean | Ù‡Ù„ ØªÙ… Ø¯ÙØ¹ Ø§Ù„Ø³Ù„ÙØ©ØŸ |
| `notes` | String | Ù…Ù„Ø§Ø­Ø¸Ø§Øª |

### ğŸ’¡ Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:

```typescript
// Ø·Ù„Ø¨ Ø³Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø©
const advance = await prisma.hR_EmployeeAdvance.create({
  data: {
    employeeId: 123,
    amount: 5000,
    reason: "Ø¸Ø±ÙˆÙ Ø¹Ø§Ø¦Ù„ÙŠØ©",
    monthlyDeduction: 500
  }
})

// Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø³Ù„ÙØ©
const approvedAdvance = await prisma.hR_EmployeeAdvance.update({
  where: { id: 1 },
  data: {
    approvalStatus: "approved",
    approvedBy: 999,
    approvedAt: new Date(),
    deductionStartDate: new Date("2025-02-01"),
    remainingBalance: 5000,
    isPaid: true
  }
})

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø´Ù‡Ø±ÙŠ
const updateBalance = await prisma.hR_EmployeeAdvance.update({
  where: { id: 1 },
  data: {
    remainingBalance: {
      decrement: 500
    }
  }
})
```

---

## ğŸ’µ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (HR_MonthlyPayroll)

### Ø§Ù„ØºØ±Ø¶:
Ø¥Ø¯Ø§Ø±Ø© Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù…Ø¹ Ø§Ù„Ø¨Ø¯Ù„Ø§Øª ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª.

### Schema:

```prisma
model HR_MonthlyPayroll {
  id                Int       @id @default(autoincrement())
  employeeId        Int
  month             Int       // 1-12
  year              Int
  
  // Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙˆØ§Ù„Ø¨Ø¯Ù„Ø§Øª
  basicSalary       Float
  housingAllowance  Float     @default(0)
  transportAllowance Float    @default(0)
  foodAllowance     Float     @default(0)
  fieldAllowance    Float     @default(0)
  otherAllowances   Float     @default(0)
  
  // Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª
  advances          Float     @default(0)
  penalties         Float     @default(0)
  absences          Float     @default(0)
  otherDeductions   Float     @default(0)
  
  // Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
  grossSalary       Float
  totalDeductions   Float
  netSalary         Float
  
  // Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹
  paymentStatus     String    @default("pending") // pending, paid, cancelled
  paymentDate       DateTime?
  paymentMethod     String?   // cash, bank_transfer
  
  notes             String?
  
  // Relations
  employee          Employee @relation("EmployeePayrolls", fields: [employeeId], references: [id], onDelete: Cascade)
  
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  
  @@unique([employeeId, month, year])
  @@index([employeeId])
  @@index([month, year])
  @@index([paymentStatus])
}
```

### ğŸ“‹ Ø§Ù„Ø­Ù‚ÙˆÙ„:

| Ø§Ù„Ù‚Ø³Ù… | Ø§Ù„Ø­Ù‚ÙˆÙ„ |
|------|--------|
| **Ø§Ù„Ø±Ø§ØªØ¨** | basicSalary, housingAllowance, transportAllowance, foodAllowance, fieldAllowance, otherAllowances |
| **Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª** | advances, penalties, absences, otherDeductions |
| **Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ** | grossSalary, totalDeductions, netSalary |
| **Ø§Ù„Ø¯ÙØ¹** | paymentStatus, paymentDate, paymentMethod |

### ğŸ“Š Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª:

```typescript
// Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
grossSalary = basicSalary + 
              housingAllowance + 
              transportAllowance + 
              foodAllowance + 
              fieldAllowance + 
              otherAllowances

// Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª
totalDeductions = advances + 
                  penalties + 
                  absences + 
                  otherDeductions

// Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„ØµØ§ÙÙŠ
netSalary = grossSalary - totalDeductions
```

### ğŸ’¡ Ù…Ø«Ø§Ù„ ÙƒØ§Ù…Ù„ Ù„Ø­Ø³Ø§Ø¨ Ø±Ø§ØªØ¨:

```typescript
// Ø­Ø³Ø§Ø¨ Ø±Ø§ØªØ¨ Ø´Ù‡Ø± ÙŠÙ†Ø§ÙŠØ± 2025
const employee = await prisma.employee.findUnique({
  where: { id: 123 }
})

// Ø¬Ù„Ø¨ Ø§Ù„Ø³Ù„Ù Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø©
const monthlyAdvances = await prisma.hR_EmployeeAdvance.findMany({
  where: {
    employeeId: 123,
    remainingBalance: { gt: 0 }
  }
})

const totalAdvances = monthlyAdvances.reduce((sum, adv) => 
  sum + (adv.monthlyDeduction || 0), 0
)

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø§ØªØ¨
const grossSalary = 
  employee.basicSalary +
  (employee.housingAllowance || 0) +
  (employee.transportAllowance || 0) +
  (employee.foodAllowance || 0) +
  (employee.fieldAllowanceRate || 0)

const totalDeductions = totalAdvances + 0 + 0 + 0 // Ø³Ù„Ù + ØºØ±Ø§Ù…Ø§Øª + ØºÙŠØ§Ø¨ + Ø£Ø®Ø±Ù‰

const netSalary = grossSalary - totalDeductions

// Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¬Ù„ Ø§Ù„Ø±Ø§ØªØ¨
const payroll = await prisma.hR_MonthlyPayroll.create({
  data: {
    employeeId: 123,
    month: 1,
    year: 2025,
    basicSalary: employee.basicSalary,
    housingAllowance: employee.housingAllowance || 0,
    transportAllowance: employee.transportAllowance || 0,
    foodAllowance: employee.foodAllowance || 0,
    fieldAllowance: employee.fieldAllowanceRate || 0,
    advances: totalAdvances,
    grossSalary,
    totalDeductions,
    netSalary,
    paymentStatus: "pending"
  }
})
```

---

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± (HR_AttendanceException)

### Ø§Ù„ØºØ±Ø¶:
ØªØ³Ø¬ÙŠÙ„ Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± (ØªØ£Ø®ÙŠØ±ØŒ Ø§Ù†ØµØ±Ø§Ù Ù…Ø¨ÙƒØ±ØŒ ØºÙŠØ§Ø¨ØŒ Ø¹Ù…Ù„ Ø¥Ø¶Ø§ÙÙŠ).

### Schema:

```prisma
model HR_AttendanceException {
  id                Int       @id @default(autoincrement())
  employeeId        Int
  date              DateTime
  exceptionType     String    // late, early_leave, absence, overtime
  hours             Float?
  reason            String?
  status            String    @default("pending") // pending, approved, rejected
  approvedBy        Int?
  
  // Relations
  employee          Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  
  @@index([employeeId])
  @@index([date])
  @@index([status])
}
```

### ğŸ“‹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª:

- **late** â° - ØªØ£Ø®ÙŠØ±
- **early_leave** ğŸƒ - Ø§Ù†ØµØ±Ø§Ù Ù…Ø¨ÙƒØ±
- **absence** âŒ - ØºÙŠØ§Ø¨
- **overtime** â±ï¸ - Ø¹Ù…Ù„ Ø¥Ø¶Ø§ÙÙŠ

### ğŸ’¡ Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:

```typescript
// ØªØ³Ø¬ÙŠÙ„ ØªØ£Ø®ÙŠØ±
const lateException = await prisma.hR_AttendanceException.create({
  data: {
    employeeId: 123,
    date: new Date("2025-01-15"),
    exceptionType: "late",
    hours: 1.5,
    reason: "Ø¸Ø±ÙˆÙ Ø·Ø§Ø±Ø¦Ø©"
  }
})

// ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ Ø¥Ø¶Ø§ÙÙŠ
const overtime = await prisma.hR_AttendanceException.create({
  data: {
    employeeId: 123,
    date: new Date("2025-01-20"),
    exceptionType: "overtime",
    hours: 3,
    status: "approved",
    approvedBy: 999
  }
})
```

---

## ğŸ”— Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„

```
Employee (Ø§Ù„Ù…ÙˆØ¸Ù)
    â†“
    â”œâ”€â”€ HR_WorkRotation (Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ù…Ù„) - One to Many
    â”œâ”€â”€ HR_EmployeeLeave (Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª) - One to Many
    â”œâ”€â”€ HR_EmployeeAdvance (Ø§Ù„Ø³Ù„Ù) - One to Many
    â”œâ”€â”€ HR_MonthlyPayroll (Ø§Ù„Ø±ÙˆØ§ØªØ¨) - One to Many
    â””â”€â”€ HR_AttendanceException (Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±) - One to Many
```

---

## ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ù…ÙƒÙ†Ø©

### 1. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
```typescript
const activeRotations = await prisma.hR_WorkRotation.findMany({
  where: { status: 'active' },
  include: { employee: true }
})
```

### 2. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
```typescript
const pendingLeaves = await prisma.hR_EmployeeLeave.findMany({
  where: { status: 'pending' },
  include: { 
    employee: true,
    replacement: true
  }
})
```

### 3. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù„Ù Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø©
```typescript
const unpaidAdvances = await prisma.hR_EmployeeAdvance.findMany({
  where: { 
    approvalStatus: 'approved',
    remainingBalance: { gt: 0 }
  },
  include: { employee: true }
})
```

### 4. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
```typescript
const monthlyPayrolls = await prisma.hR_MonthlyPayroll.findMany({
  where: { 
    month: 1,
    year: 2025 
  },
  include: { employee: true },
  orderBy: { netSalary: 'desc' }
})
```

---

## ğŸ¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

### âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:
1. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ù„Ø§ ØªØªØ¯Ø§Ø®Ù„
2. ØªØ­Ù‚Ù‚ Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
3. Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ù„Ù Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### âœ… Ø§Ù„Ø£Ù…Ø§Ù†:
- Ø§Ø³ØªØ®Ø¯Ù… transactions Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙˆØ§ØªØ¨ Ù…ØªØ¹Ø¯Ø¯Ø©
- ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª
- Ø³Ø¬Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù…Ø¹ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

### âœ… Ø§Ù„Ø£Ø¯Ø§Ø¡:
- Ø§Ø³ØªØ®Ø¯Ù… indexes Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹
- Ø§Ø³ØªØ®Ø¯Ù… pagination Ù„Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø·ÙˆÙŠÙ„Ø©
- Ø§Ø³ØªØ®Ø¯Ù… select() Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙ‚Ø·

---

## ğŸš€ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©

1. âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù€ Handlers Ù„Ù„ØªØ¯ÙÙ‚Ø§Øª
2. âœ… Ø¨Ù†Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
3. âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
4. âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
5. âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„

---

**ØªÙ… Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø©:** Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ  
**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 2025-10-23  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 1.0
